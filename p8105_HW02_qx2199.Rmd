---
title: "Homework 2"
author: Qianhui Xu
output: github_document
---

```{r setup}
library(tidyverse)
library(readxl)
library(knitr)
```

#Problem 1

##First, define a path to the Trash Wheel dataset. 

```{r}
path_trashwheel = "./Trash-Wheel-Collection-Totals-8-6-19.xlsx"
```


##Read and clean the Mr. Trash Wheel dataset. 

```{r}
trashwheel_df = 
	read_excel(
		path = path_trashwheel,
		sheet = "Mr. Trash Wheel",
		range = cell_cols("A2:N408")) %>% 
	janitor::clean_names() %>% 
  drop_na(dumpster) %>%
	mutate(
		sports_balls = round(sports_balls),
		sports_balls = as.integer(sports_balls)
	)
```

##Read and clean precipitation data for 2018 and 2017. 

```{r}
precipitation_2017 = 
	read_excel(
	  path = path_trashwheel,
		sheet = "2017 Precipitation",
		skip = 1
	) %>% 
	janitor::clean_names() %>% 
	drop_na(month) %>% 
	mutate(year = 2017) %>% 
	relocate(year)


precipitation_2018 = 
	read_excel(
	  path = path_trashwheel,
		sheet = "2018 Precipitation",
		skip = 1
	) %>% 
	janitor::clean_names() %>% 
	drop_na(month) %>% 
	mutate(year = 2018) %>% 
	relocate(year)

```

##Now combine annual precipitation dataframes. In the following code chunk, I create a `month_df` dataframe. 

```{r}
month_df = 
	tibble(
		month = 1:12,
		month_name = month.name
	)
precipitation_bind_df = 
	bind_rows(precipitation_2018, precipitation_2017)

precipitation_bind_df = 
	left_join(precipitation_bind_df, month_df, by = "month")

```

##data description
This dataset contains information from the Mr. Trashwheel trash collector in Baltimore, Maryland. As trash enters the inner harbor, the trashwheel collects that trash, and stores it in a dumpster. The dataset contains information on year, month, and trash collected, include some specific kinds of trash. 

There are a total of `r nrow(trashwheel_df)` rows in our final dataset.There are a total of `r nrow(precipitation_bind_df)` rows in the combined precipitation dataset of 2017 and 2018.

The median number of sports balls found in a dumpster in 2017 was `r trashwheel_df %>% filter(year == 2017) %>% pull(sports_balls) %>% median()`
The total precipitation in 2018 was `r precipitation_bind_df %>% filter(year == 2018) %>% pull(total) %>% sum()` inches.

#Problem 2

##First, define a path to the NYC Transit dataset. 

```{r}
path_subway = "./NYC_Transit_Subway_Entrance_And_Exit_Data.csv"
```
,
##Read and clean NYC subway data.
###Here we first read the dataset, then we need to mak sure that the types of each variable should be the type we want. We first notice that the variable entry and variable vending is stored as character variables,however, we need to switch them into logic variables.
###Also, we could notice that some of the route variables (route8,route9,route10,route10,route11) are double, we need to switch the type of the route variable into character.

```{r read the nyc_subway_dataset, message=FALSE}
nyc_subway_df = 
      read_csv(
             file = path_subway,col_types = cols( Route8 = col_character(), Route9 = col_character() , Route10 = col_character() , Route11 = col_character() )
             ) %>% 
      janitor::clean_names() %>% 
      select(line, station_name, station_latitude, station_longitude, route1, route2, route3, route4, route5, route6, route7, route8, route9, route10, route11, entry, vending, entrance_type, ada) %>% 
   
   mutate( entry = ifelse(entry == "YES", TRUE , FALSE) , 
            vending = ifelse(entry == "YES", TRUE , FALSE),
      )
     
```


This dataset contains information related to each entrance and exit for each subway station in NYC. The dataset contains information on variables such as
`r names(nyc_subway_df)`. There are `r nrow(nyc_subway_df)` rows and `r ncol(nyc_subway_df)` columns. There are `r nyc_subway_df %>% select(station_name, line) %>% distinct() %>% nrow()` distinct stations.
There are `r nyc_subway_df %>% filter(ada == T) %>% select(station_name, line) %>% distinct() %>% nrow()` stations that are ADA compliant.Besides, the proportion of station entrances without vending allow entrance is `r nrow(filter(nyc_subway_df, entry == F & vending == F))/nrow(filter(nyc_subway_df, vending == F))`

##Reform the data so that route number and route name are distinct variables

```{r}
nyc_subway_new =
  pivot_longer(
    nyc_subway_df,
    route1:route11,
    names_to = "route_number",
    names_prefix = "route",
    values_to = "route_name",
    )
```

###There are `r nyc_subway_new %>% filter(route_name == "A") %>% select(station_name, line) %>% distinct() %>% nrow()` distinct stations serve the A train.Among the stations that serve the A train, `r nyc_subway_new %>% filter(route_name == "A" & ada == T) %>% select(station_name, line) %>% distinct() %>% nrow()` stations that are ADA compliant.








